(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-06e69eda"],{"17a6":function(t,o,e){"use strict";e.r(o);var s=function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{staticClass:"container goods-detail-container"},[e("div",{staticClass:"back-btn"},[e("van-button",{attrs:{icon:"arrow-left",round:"",color:"#c5c5c5",type:"primary"},on:{click:t.backHome}})],1),e("van-swipe",{staticClass:"goods-detail-swipe",attrs:{autoplay:3e3,"indicator-color":"white"}},t._l(t.banner,(function(t){return e("van-swipe-item",{key:t.id},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.pic,expression:"item.pic"}]})])})),1),e("div",{staticClass:"goods-detail-title"},[e("div",{staticClass:"goods-detail-title-top"},[e("span",{staticClass:"goods-name"},[t._v(t._s(t.basicInfo.name))]),t.hasFav?e("van-button",{staticClass:"collected",attrs:{color:"#ee0a24",round:"",plain:"",size:"mini"},on:{click:function(o){return t.addToFav(t.basicInfo.id)}}},[t._v("取消收藏")]):t._e(),t.hasFav?t._e():e("van-button",{staticClass:"collected",attrs:{color:"#ee0a24",round:"",plain:"",size:"mini"},on:{click:function(o){return t.addToFav(t.basicInfo.id)}}},[t._v("收藏")])],1),e("div",{staticClass:"goods-detail-title-desc",domProps:{innerHTML:t._s(t.content)}}),t.basicInfo.kanjia?t._e():e("div",{staticClass:"goods-detail-title-price"},[t._v("￥"+t._s(t.basicInfo.minPrice))]),t.basicInfo.kanjia?e("div",{staticClass:"goods-detail-title-price"},[t._v("￥"+t._s(t.basicInfo.kanjiaPrice))]):t._e(),e("div",{staticClass:"goods-detail-title-bottom"},[e("span",[t._v("浏览: "+t._s(t.basicInfo.views))]),e("span",[t._v("购买: "+t._s(t.basicInfo.numberSells))]),e("span",[t._v("好评: "+t._s(t.basicInfo.numberGoodReputation))])])]),e("div",{staticClass:"goods-detail-lingjuan"},[e("van-coupon-cell",{attrs:{coupons:t.coupons,"chosen-coupon":t.chosenCoupon},on:{click:function(o){t.showList=!0}}}),e("van-popup",{staticStyle:{height:"90%","padding-top":"4px"},attrs:{round:"",position:"bottom"},model:{value:t.showList,callback:function(o){t.showList=o},expression:"showList"}},[e("van-coupon-list",{attrs:{coupons:t.coupons,"chosen-coupon":t.chosenCoupon,"disabled-coupons":t.disabledCoupons},on:{change:t.onChange,exchange:t.onExchange}})],1)],1),e("div",{staticClass:"goods-detail-edition"},[e("van-cell",{attrs:{title:t.propTitle,"is-link":""},on:{click:t.changeShowShopSku}}),e("van-sku",{attrs:{sku:t.skuData.sku,goods:t.skuData.goods_info},on:{"sku-selected":t.onSkuSelected,"add-cart":t.onAddToCart},model:{value:t.showShopSku,callback:function(o){t.showShopSku=o},expression:"showShopSku"}})],1),e("div",{staticClass:"goods-detail-service"},[e("van-cell",{attrs:{title:"服务 担保","is-link":""}})],1),e("div",{staticClass:"goods-detail-comment"},[e("van-cell",{attrs:{title:"评论("+this.reputation.length+")",value:"全部评论","is-link":""}}),t._l(t.reputation,(function(o){return e("div",{key:o.id,staticClass:"goods-detail-comment-item"},[e("div",{staticClass:"goods-detail-comment-item-top"},[e("div",{staticClass:"goods-comment-item-user"},[e("img",{attrs:{src:o.user.avatarUrl}}),e("span",{staticClass:"username"},[t._v(t._s(o.user.nick))])]),e("div",{staticClass:"goods-comment-item-star"},[e("van-rate",{attrs:{readonly:"",size:"14"},model:{value:o.goods.goodReputationStr,callback:function(e){t.$set(o.goods,"goodReputationStr",e)},expression:"item.goods.goodReputationStr"}})],1)]),e("div",{staticClass:"goods-comment-item-content"},[t._v(" "+t._s(o.goods.goodReputationRemark)+" ")]),e("div",{staticClass:"goods-comment-item-edition"},[t._v(" "+t._s(o.goods.property)+" ")])])}))],2),e("div",{staticClass:"goods-detail-detail"},[t._m(0),t._l(t.banner,(function(t){return e("div",{key:t.id,staticClass:"goods-detail-desc-img"},[e("img",{attrs:{src:t.pic,alt:""}})])}))],2),e("van-goods-action",[e("van-goods-action-icon",{attrs:{icon:"wap-home-o",text:"首页",dot:"",to:"/home"}}),e("van-goods-action-icon",{attrs:{icon:"comment-o",text:"客服"}}),e("van-goods-action-icon",{attrs:{icon:"shopping-cart-o",text:"购物车",badge:t.cartGoods.length,to:"/cart"}}),e("van-goods-action-button",{attrs:{type:"warning",text:"加入购物车"},on:{click:t.changeShowShopSku}}),e("van-goods-action-button",{attrs:{type:"danger",text:"立即购买"},on:{click:t.changeShowShopSku}})],1)],1)},i=[function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",{staticClass:"section-header common-h2"},[e("span",{staticClass:"common-h2-title"},[t._v("商品列表")])])}],n=(e("99af"),e("7db0"),e("c740"),e("4160"),e("a15b"),e("d81d"),e("13d5"),e("b0c0"),e("b680"),e("d3b7"),e("ac1f"),e("5319"),e("159b"),e("d072")),a={available:1,condition:"无使用门槛\n最多优惠12元",reason:"",value:150,name:"优惠券名称",startAt:1489104e3,endAt:1514592e3,valueDesc:"1.5",unitDesc:"元"},c={data:function(){return{active:0,banner:[],list:[],listKanjia:[],listPintuan:[],pintuanSets:[],goodsMap:{},basicInfo:{},reputation:[],content:{},properties:[],propTitle:"请选择版本",showShopSku:!1,skuData:{goods_id:"",quota:0,quota_used:0,goods_info:{},sku:{price:"1.00",stock_num:100,none_sku:!1,hide_stock:!1,collection_id:2261,tree:[],list:[],messages:[]}},goods:{picture:"https://img.yzcdn.cn/2.jpg"},messageConfig:{uploadImg:function(){return new Promise((function(t){setTimeout((function(){return t("https://img.yzcdn.cn/upload_files/2017/02/21/FjKTOxjVgnUuPmHJRdunvYky9OHP.jpg!100x100.jpg")}),1e3)}))},uploadMaxSize:3,placeholderMap:{text:"xxx",tel:"xxx"},initialMessages:{"留言":"留言信息"}},starNum:5,showList:!1,chosenCoupon:-1,coupons:[a],disabledCoupons:[a],hasFav:!1,cartGoods:[]}},created:function(){this.getGoodsDetail(this.$route.query.id),this.getCart(),this.getReputation(this.$route.query.id)},filters:{},mounted:function(){window.addEventListener("scroll",this.onPageScroll,!1)},beforeDestroy:function(){window.removeEventListener("scroll",this.onPageScroll,!1)},computed:{},methods:{rateChange:function(t){var o=5;switch(t){case 0:o=1;break;case 1:o=3;break;case 2:o=5;break;default:o=5}return o},getCart:function(){this.cartGoods=n["a"].storage.get("cartInfo")||[],console.log(this.cartGoods)},backHome:function(){this.$router.go(-1)},checkFav:function(t){var o=this;this.$request.get("/shop/goods/fav/check",{goodsId:t,token:n["a"].storage.get("token")}).then((function(t){console.log(t),0===t.code&&"已收藏"===t.data&&(o.hasFav=!0)}))},getGoodsDetail:function(t){var o=this;this.$request.get("/shop/goods/detail",{id:t}).then((function(t){0===t.code?(console.log(t),o.banner=t.data.pics,o.basicInfo=t.data.basicInfo,o.content=t.data.content,o.logistics=t.data.logistics||{},o.properties=t.data.properties||[],o.initSkuData(o.properties,o.basicInfo),o.checkFav(o.basicInfo.id)):o.$toast(t.msg)}))},getReputation:function(t){var o=this;this.$request.post("/shop/goods/reputation",{goodsId:t}).then((function(t){console.log("res",t),o.reputation=[t.data[0],t.data[1]],o.reputation.map((function(t){return t.goods.goodReputationStr=o.rateChange(t.goods.goodReputationStr)})),console.log("reputation",o.reputation)}))},initSkuData:function(t,o){var e=t.map((function(t,o){return{k:t.name,k_id:t.id,v:t.childsCurGoods,k_s:"s"+(o+1),count:t.childsCurGoods.length}}));if(this.skuData.goods_info={title:o.name,picture:o.pic},this.skuData.goods_id=o.id,this.skuData.sku.price=o.minPrice,this.skuData.sku.stock_num=o.stores,this.skuData.sku.tree=e,0===e.length)return this.propTitle="",void(this.skuData.none_sku=!0);if(this.propTitle="选择 ".concat(e.reduce((function(t,o){return t+" "+o.k}),"")),e.length>0){var s=function(t){return t.length<2?t[0]||[]:[].reduce.call(t,(function(t,o){var e=[];return t.forEach((function(t){o.forEach((function(o){var s=[].concat(Array.isArray(t)?t:[t]);s.push(o),e.push(s)}))})),e}))},i=s(Array.prototype.concat.apply([],e.map((function(t){return[t.v]}))));this.skuData.sku.list=i.map((function(t){var e={price:parseFloat(100*o.minPrice),stock_num:o.stores};return Array.isArray(t)?(t.forEach((function(t,o){e["s".concat(o+1)]=t.id,e.propertyChildIds="".concat(e.propertyChildIds||"").concat(t.propertyId,":").concat(t.id,","),e.id="".concat(e.id||"").concat(t.propertyId).concat(t.id)})),e):(e["s1"]=t.id,e.propertyChildIds="".concat(t.propertyId,":").concat(t.id,","),e.id="".concat(t.propertyId).concat(t.id),e)}))}},onSkuSelected:function(t){var o=this;if(console.log("this.skuData",this.skuData),console.log(t),t.selectedSkuComb){var e=[];this.properties.forEach((function(o,s){var i=o.childsCurGoods.find((function(o){return o.id===t.selectedSku["s".concat(s+1)]}));e.push(i.name)})),this.propTitle="已选 ".concat(e.join(",")),this.getGoodsPrice(this.basicInfo.id,t.selectedSkuComb.propertyChildIds,(function(e){o.basicInfo.minPrice=e.data.price,o.basicInfo.originalPrice=e.data.originalPrice,o.basicInfo.pingtuanPrice=e.data.pingtuanPrice,o.basicInfo.stores=e.data.stores,t.selectedSkuComb.price=parseFloat(100*e.data.price),t.selectedSkuComb.stock_num=e.data.stores,t.selectedSkuComb.propertyChildIds=e.data.propertyChildIds}))}},getGoodsPrice:function(t,o,e){this.$request.post("/shop/goods/price",{goodsId:t,propertyChildIds:o}).then((function(t){e(t)}))},onChange:function(t){this.showList=!1,this.chosenCoupon=t},onExchange:function(t){this.coupons.push(a)},changeShowShopSku:function(){this.showShopSku=!0},onAddToCart:function(t){t.goodsId=this.skuData.goods_id;var o=n["a"].storage.get("cartInfo")||[];if(this.properties.length){var e=o.findIndex((function(o){return o.goodsId===t.goodsId&&o.propertyChildIds===t.selectedSkuComb.propertyChildIds}));o.length&&e>-1?o[e].selectedNum=o[e].selectedNum+t.selectedNum:o.push({id:"".concat(Date.now()),goodsId:t.goodsId,propertyChildIds:t.selectedSkuComb.propertyChildIds,propTitle:this.propTitle.replace("已选 ",""),price:parseFloat((t.selectedSkuComb.price/100).toFixed(2)),selectedNum:t.selectedNum,messages:t.messages,name:this.basicInfo.name,characteristic:this.basicInfo.characteristic,pic:this.basicInfo.pic,marketing:{}})}else{var s=o.findIndex((function(o){return o.goodsId===t.goodsId}));o.length&&s>-1?o[s].selectedNum=o[s].selectedNum+t.selectedNum:o.push({id:"".concat(Date.now()),goodsId:t.goodsId,propertyChildIds:"",propTitle:this.propTitle.replace("已选 ",""),price:this.basicInfo.minPrice,selectedNum:t.selectedNum,messages:t.messages,name:this.basicInfo.name,characteristic:this.basicInfo.characteristic,pic:this.basicInfo.pic,marketing:{}})}this.$toast({message:"已成功添加到购物车",duration:1500}),n["a"].storage.set("cartInfo",o),this.showShopSku=!this.showShopSku},addToFav:function(t){var o=this;this.hasFav?this.$request.post("/shop/goods/fav/delete",{goodsId:t,token:n["a"].storage.get("token")}).then((function(t){console.log(t),0===t.code&&(o.hasFav=!1)})):this.$request.post("/shop/goods/fav/add",{goodsId:t,token:n["a"].storage.get("token")}).then((function(t){console.log(t),o.hasFav=!0}))}}},r=c,d=(e("194e"),e("2877")),u=Object(d["a"])(r,s,i,!1,null,"43c297f5",null);o["default"]=u.exports},"194e":function(t,o,e){"use strict";e("519f")},"519f":function(t,o,e){},"7db0":function(t,o,e){"use strict";var s=e("23e7"),i=e("b727").find,n=e("44d2"),a=e("ae40"),c="find",r=!0,d=a(c);c in[]&&Array(1)[c]((function(){r=!1})),s({target:"Array",proto:!0,forced:r||!d},{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(c)},"99af":function(t,o,e){"use strict";var s=e("23e7"),i=e("d039"),n=e("e8b5"),a=e("861d"),c=e("7b0b"),r=e("50c4"),d=e("8418"),u=e("65f0"),l=e("1dde"),p=e("b622"),h=e("2d00"),g=p("isConcatSpreadable"),f=9007199254740991,m="Maximum allowed index exceeded",v=h>=51||!i((function(){var t=[];return t[g]=!1,t.concat()[0]!==t})),k=l("concat"),b=function(t){if(!a(t))return!1;var o=t[g];return void 0!==o?!!o:n(t)},C=!v||!k;s({target:"Array",proto:!0,forced:C},{concat:function(t){var o,e,s,i,n,a=c(this),l=u(a,0),p=0;for(o=-1,s=arguments.length;o<s;o++)if(n=-1===o?a:arguments[o],b(n)){if(i=r(n.length),p+i>f)throw TypeError(m);for(e=0;e<i;e++,p++)e in n&&d(l,p,n[e])}else{if(p>=f)throw TypeError(m);d(l,p++,n)}return l.length=p,l}})},b0c0:function(t,o,e){var s=e("83ab"),i=e("9bf2").f,n=Function.prototype,a=n.toString,c=/^\s*function ([^ (]*)/,r="name";s&&!(r in n)&&i(n,r,{configurable:!0,get:function(){try{return a.call(this).match(c)[1]}catch(t){return""}}})},c740:function(t,o,e){"use strict";var s=e("23e7"),i=e("b727").findIndex,n=e("44d2"),a=e("ae40"),c="findIndex",r=!0,d=a(c);c in[]&&Array(1)[c]((function(){r=!1})),s({target:"Array",proto:!0,forced:r||!d},{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(c)}}]);
//# sourceMappingURL=chunk-06e69eda.238d3342.js.map